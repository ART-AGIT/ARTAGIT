<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.artagit.web.dao.BoardListDao">
	<select id="getList" resultType="com.artagit.web.entity.BoardListView">
		select
   b.*, 
    (select count(id) from Comment where Comment.postid = b.id group by postId) commentTotal,
    (select nickname from Member where  id = b.memId ) nickname,
    (select name from BoardCategory where id = b.roleId) name,
     (select count(memId) from BoardLike where postId = b.id group by postId) hearts
from Board b
<trim prefix="WHERE" prefixOverrides="AND | OR">
			<if test="roleId != null and roleId != 0">
				roleId = #{roleId}
			</if>
			and useYN = "Y"
		</trim>
order by regDate desc;
		
	</select>
	<select id="getListInit" resultType="com.artagit.web.entity.BoardListView">
	select
   b.*, 
    (select count(id) from Comment where Comment.postid = b.id group by postId) commentTotal,
    (select nickname from Member where  id = b.memId ) nickname,
    (select name from BoardCategory where id = b.roleId) name,
    (select count(memId) from BoardLike where postId = b.id group by postId) hearts
	from Board b
	where
			
			 useYN = "Y"
		
order by regDate desc;
		</select>
		
		<select id="getListById" resultType="com.artagit.web.entity.BoardListView">
		select
  	 b.*, 
    (select count(id) from Comment where Comment.postid = b.id group by postId) commentTotal,
    (select nickname from Member where  id = b.memId ) nickname,
    (select name from BoardCategory where id = b.roleId) name
	from Board b
		where
					
					 useYN = "Y" and memId = #{id}
		order by regDate desc;
		</select>
		<select id="getLikeList" resultType="com.artagit.web.entity.BoardListView">
		select
  	 b.*, 
    (select count(id) from Comment where Comment.postid = b.id group by postId) commentTotal,
    (select nickname from Member where  id = b.memId ) nickname,
    (select name from BoardCategory where id = b.roleId) name,
    (select count(memId) from BoardLike where postId = b.id and memId = #{memId} group by postId) hearts
	from Board b
		where
					
					 useYN = "Y" and memId = #{id}
		order by regDate desc;
		</select>
	
</mapper>
 
